/*! lena-js 2017-10-29 */
var LenaJS={};LenaJS.getImage=function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");return c.drawImage(a,0,0),c.getImageData(0,0,a.width,a.height)},LenaJS.printCanvas=function(a,b){a.width=b.width,a.height=b.height;var c=a.getContext("2d");c.putImageData(b,0,0)},LenaJS.filterImage=function(a,b,c){var d=[this.getImage(c)];return this.printCanvas(a,b.apply(null,d))},LenaJS.redrawCanvas=function(a,b){var c=a.getContext("2d");return c=[c.getImageData(0,0,a.width,a.height)],this.printCanvas(a,b.apply(null,c))},LenaJS.convolution=function(a,b){for(var c=Math.round(Math.sqrt(b.length)),d=Math.floor(c/2),e=a.data,f=a.width,g=a.height,h=document.createElement("canvas"),i=h.getContext("2d"),j=i.createImageData(f,g),k=0;g>k;k++)for(var l=0;f>l;l++){for(var m=4*(k*f+l),n=0,o=0,p=0,q=0;c>q;q++)for(var r=0;c>r;r++){var s=k+q-d,t=l+r-d;if(s>=0&&g>s&&t>=0&&f>t){var u=4*(s*f+t),v=b[q*c+r];n+=e[u]*v,o+=e[u+1]*v,p+=e[u+2]*v}}j.data[m]=n,j.data[m+1]=o,j.data[m+2]=p,j.data[m+3]=255}return j},LenaJS.gradient=function(a,b){for(var c=a.data,d=a.width,e=a.height,f=b.data,g=document.createElement("canvas"),h=g.getContext("2d"),i=h.createImageData(d,e),j=new Array(c.length).fill(0),k=0;e>k;k++)for(var l=0;d>l;l++){var m=4*(k*d+l);i.data[m]=Math.sqrt(Math.pow(c[m],2)+Math.pow(f[m],2)),i.data[m+1]=Math.sqrt(Math.pow(c[m+1],2)+Math.pow(f[m+1],2)),i.data[m+2]=Math.sqrt(Math.pow(c[m+2],2)+Math.pow(f[m+2],2)),i.data[m+3]=255,j[m]=Math.atan2(f[m],c[m]),j[m+1]=Math.atan2(f[m+1],c[m+1]),j[m+2]=Math.atan2(f[m+2],c[m+2]),j[m+3]=255}var n={magnitude:i,direction:j};return n},LenaJS.histogram=function(a){"use strict";for(var b=this.getImage(a),c=new Array(257).join("0").split(""),d={r:c.map(Number),g:c.map(Number),b:c.map(Number)},e=0;e<b.data.length;e+=4)d.r[b.data[e]]++,d.g[b.data[e+1]]++,d.b[b.data[e+2]]++;return d},LenaJS.nonMaximumSuppression=function(a,b){for(var c=Math.round(Math.sqrt(25)),d=Math.floor(c/2),e=a.data,f=a.width,g=a.height,h=document.createElement("canvas"),i=h.getContext("2d"),j=i.createImageData(f,g),k=0;g>k;k++)for(var l=0;f>l;l++){for(var m=4*(k*f+l),n=e[m],o=e[m+1],p=e[m+2],q=0;c>q;q++)for(var r=0;c>r;r++){var s=k+q-d,t=l+r-d;if(s>=0&&g>s&&t>=0&&f>t){var u=4*(s*f+t),v=Math.atan2(s-k,t-l);n=e[u]*Math.abs(Math.cos(b[m]-v))>n?0:n,o=e[u+1]*Math.abs(Math.cos(b[m+1]-v))>o?0:o,p=e[u+2]*Math.abs(Math.cos(b[m+2]-v))>p?0:p}}j.data[m]=2*n,j.data[m+1]=2*o,j.data[m+2]=2*p,j.data[m+3]=255}return j},LenaJS.bigGaussian=function(a){var b=159,c=[2/b,4/b,5/b,4/b,2/b,4/b,9/b,12/b,9/b,4/b,5/b,12/b,15/b,12/b,5/b,4/b,9/b,12/b,9/b,4/b,2/b,4/b,5/b,4/b,2/b];return LenaJS.convolution(a,c)},LenaJS.canny=function(a){a=LenaJS.bigGaussian(a);var b=LenaJS.sobelHorizontal(a),c=LenaJS.sobelVertical(a),d=LenaJS.gradient(b,c),e=LenaJS.laplacian(a);return a=LenaJS.nonMaximumSuppression(e,d.direction),LenaJS.thresholding(a,8)},LenaJS.gaussian=function(a){var b=16,c=[1/b,2/b,1/b,2/b,4/b,2/b,1/b,2/b,1/b];return LenaJS.convolution(a,c)},LenaJS.grayscale=function(a){for(var b=0;b<a.data.length;b+=4){var c=a.data[b],d=a.data[b+1],e=a.data[b+2];a.data[b]=a.data[b+1]=a.data[b+2]=.2126*c+.7152*d+.0722*e}return a},LenaJS.highpass=function(a){var b=[-1,-1,-1,-1,8,-1,-1,-1,-1];return LenaJS.convolution(a,b)},LenaJS.invert=function(a){for(var b=0;b<a.data.length;b+=4)a.data[b]=255-a.data[b],a.data[b+1]=255-a.data[b+1],a.data[b+2]=255-a.data[b+2];return a},LenaJS.laplacian=function(a){var b=[0,-1,0,-1,4,-1,0,-1,0];return LenaJS.convolution(a,b)},LenaJS.lowpass3=function(a){var b=1/9,c=[b,b,b,b,b,b,b,b,b];return LenaJS.convolution(a,c)},LenaJS.lowpass5=function(a){var b=.04,c=[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b];return LenaJS.convolution(a,c)},LenaJS.mirror=function(a){for(var b=[],c=4*a.width,d=0;d<a.height;d++)for(var e=d*c,f=a.width/2,g=0;f>g;g++){var h=4*g,i=h+e,j=c-h-4+e;b[0]=a.data[i],b[1]=a.data[i+1],b[2]=a.data[i+2],b[3]=a.data[i+3],a.data[i]=a.data[j],a.data[i+1]=a.data[j+1],a.data[i+2]=a.data[j+2],a.data[i+3]=a.data[j+3],a.data[j]=b[0],a.data[j+1]=b[1],a.data[j+2]=b[2],a.data[j+3]=b[3]}return a},LenaJS.prewittHorizontal=function(a){var b=3,c=[1/b,1/b,1/b,0,0,0,-1/b,-1/b,-1/b];return LenaJS.convolution(a,c)},LenaJS.prewittVertical=function(a){var b=3,c=[-1/b,0,1/b,-1/b,0,1/b,-1/b,0,1/b];return LenaJS.convolution(a,c)},LenaJS.red=function(a){for(var b=a.data,c=0;c<b.length;c+=4)b[c]=b[c],b[c+1]=0,b[c+2]=0;return a},LenaJS.green=function(a){for(var b=a.data,c=0;c<b.length;c+=4)b[c]=0,b[c+2]=0;return a},LenaJS.blue=function(a){for(var b=a.data,c=0;c<b.length;c+=4)b[c]=0,b[c+1]=0;return a},LenaJS.roberts=function(a){var b=[0,0,0,1,-1,0,0,0,0];return LenaJS.convolution(a,b)},LenaJS.saturation=function(a){for(var b=2.9,c=.3086,d=.6084,e=.082,f=(1-b)*c+b,g=(1-b)*c,h=(1-b)*c,i=(1-b)*d,j=(1-b)*d+b,k=(1-b)*d,l=(1-b)*e,m=(1-b)*e,n=(1-b)*e+b,o=0;o<a.data.length;o+=4)a.data[o]=f*a.data[o]+i*a.data[o+1]+l*a.data[o+2],a.data[o+1]=g*a.data[o]+j*a.data[o+1]+m*a.data[o+2],a.data[o+2]=h*a.data[o]+k*a.data[o+1]+n*a.data[o+2];return a},LenaJS.sepia=function(a){for(var b=0;b<a.data.length;b+=4){var c=a.data[b],d=a.data[b+1],e=a.data[b+2];a.data[b]=a.data[b+1]=a.data[b+2]=.3*c+.59*d+.11*e,a.data[b]+=40,a.data[b+1]+=20,a.data[b+2]-=20}return a},LenaJS.sharpen=function(a){var b=[0,-.2,0,-.2,1.8,-.2,0,-.2,0];return LenaJS.convolution(a,b)},LenaJS.sobelHorizontal=function(a){var b=4,c=[1/b,2/b,1/b,0,0,0,-1/b,-2/b,-1/b];return a=LenaJS.convolution(a,c)},LenaJS.sobelVertical=function(a){var b=4,c=[1/b,0,-1/b,2/b,0,-2/b,1/b,0,-1/b];return a=LenaJS.convolution(a,c)},LenaJS.thresholding=function(a,b){for(var c=0;c<a.data.length;c+=4){var d=a.data[c],e=a.data[c+1],f=a.data[c+2],g=.2126*d+.7152*e+.0722*f,h=b||128;a.data[c]=a.data[c+1]=a.data[c+2]=g>h?255:0}return a};